<?php
require '../vendor/autoload.php';
$twigView = new \Slim\Extras\Views\Twig();

date_default_timezone_set('Australia/Brisbane');

$app = new \Slim\Slim(array(
	'debug' => true,
    	'view' => $twigView,
    	'templates.path' => './app/views',
));

$conn = array(
        'driver'    => 'pgsql',
        'host'      => 'localhost',
        'database'  => 'zeddb',
        'username'  => 'zeddbuser',
        'password'  => 'P4u97Ar3',
        'charset' => 'utf8',
        'prefix'    => '',
);


// Make a new connection
$app->db = Capsule\Database\Connection::make('default', $conn, true);


$api_prefix = "/api/v1/";


$app->get($api_prefix.'release/:id', 'getRelease');



function getRelease($id) {
        $app = \Slim\Slim::getInstance();
        //$release = Release::with('artist')->find($id);
echo $id;
        $release = Music::find($id);
        $res = $app->response();
        $res['Content-Type'] = 'application/json';
        $res->body($release);
}

?>
